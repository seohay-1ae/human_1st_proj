<!doctype html>
<html lang="ko">
	<head>
		<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
		<link rel="stylesheet" href="../common/styles.css" />
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>커뮤니티 게시판</title>
		<style>
			/* 기본 세팅: 전체 높이 확보 및 플렉스 레이아웃 구성 */
			html,
			body {
				height: 100%; /* 화면 전체 높이 사용 */
				margin: 0;
				padding: 0;
			}

			body {
				background-color: #f4f4f4;
				display: flex; /* body 자체에 flex , center, center 적용하면 있어서 푸터가 가로중앙+수직중앙 정렬됨 */
				flex-direction: column; /* 수직 방향 레이아웃 */
			}

			.wrapper {
				/* body에 정렬하면 전체 레이아웃 꼬이므로 wrapper로 감싸서 그 안에 컨텐츠를 넣고 정렬, footer는 wrapper 밖에 */
				flex: 1; /* 남은 공간을 채움 (푸터 밀어내기 용도) */
				display: flex;
				flex-direction: column;
				align-items: center; /* 가운데 정렬 */
				padding: 20px;
				margin-top: 100px;
			}

			.container {
				width: 90%;
				max-width: 1000px;
				margin: auto;
				background: #f4f4f4;
				padding: 20px;
				box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
				border-radius: 10px;
			}

			.header {
				display: flex;
				justify-content: space-between;
				align-items: center;
				margin-bottom: 20px;
			}

			.header h2 {
				margin: 0;
				color: #333;
			}

			.write-button {
				color: white;
				padding: 10px 20px;
				font-size: 1rem; /* 폰트 크기 줄임 */
				border: none;
				border-radius: 8px;
				text-decoration: none;
				font-weight: bold;
				transition: background-color 0.3s;
				display: inline-block; /* 버튼처럼 보이도록 설정. 부모 컨테이너의 너비를 차지함 (버튼 안의 글씨를 정확히 클릭하지 않아도 되도록) */
				background-color: #0a8b11;
			}

			.search-container {
				margin: 20px 0;
				display: flex;
				justify-content: flex-start;
			}

			.search-input {
				padding: 10px;
				font-size: 1rem;
				border: 1px solid #ccc;
				border-radius: 5px;
				width: 300px;
			}

			table {
				width: 100%;
				border-collapse: collapse;
				text-align: left;
			}

			th,
			td {
				padding: 12px;
				border-bottom: 1px solid #ddd;
			}

			th {
				background-color: #f0f0f0;
			}

			tr:hover {
				background-color: #f9f9f9;
			}

			a {
				text-decoration: none;
				color: #000;
			}
		</style>
	</head>
	<body>
		<!-- 전체 콘텐츠를 감싸는 wrapper -->
		<div class="wrapper">
			<div class="container">
				<div class="header">
					<h2>커뮤니티 게시판</h2>
					<a href="write.html" class="write-button">글쓰기</a>
				</div>

				<!-- 검색창 -->
				<div class="search-container">
					<input type="text" id="search" class="search-input" placeholder="게시글 검색..." />
				</div>

				<!-- 게시글 목록 -->
				<table>
					<thead>
						<tr>
							<th>NO.</th>
							<th>제목</th>
							<th>작성자</th>
							<th>작성일</th>
						</tr>
					</thead>
					<tbody id="post-list">
						<!-- 게시글 목록이 여기 렌더링됨 -->
					</tbody>
				</table>
			</div>
		</div>

		<!-- 게시글 표시 및 검색 기능 -->
		<script>
			$(document).ready(function () {
				let posts = JSON.parse(localStorage.getItem('posts')) || [];

				// 게시글 목록 표시 함수
				function displayPosts(filteredPosts) {
					$('#post-list').empty();
					filteredPosts.reverse().forEach((post, index) => {
						$('#post-list').append(`
              <tr>
                <td>${filteredPosts.length - index}</td>
                <td><a href="post.html?index=${filteredPosts.length - 1 - index}">${post.title}</a></td>
                <td>${post.author}</td>
                <td>${post.date}</td>
              </tr>
            `);
					});
				}

				// 처음에 모든 게시글 표시
				displayPosts(posts);

				// 검색 기능
				$('#search').on('input', function () {
					const searchQuery = $(this).val().toLowerCase();
					const filteredPosts = posts.filter((post) => {
						return (
							post.title.toLowerCase().includes(searchQuery) ||
							post.content.toLowerCase().includes(searchQuery)
						);
					});
					displayPosts(filteredPosts);
				});
			});
		</script>

		<!-- 공통 헤더 및 푸터 스크립트 로드 (바디 맨 아래에 삽입)-->
		<script defer src="../common/header.js"></script>
		<script defer src="../common/footer2.js"></script>
	</body>
</html>
