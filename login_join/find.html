<!doctype html>
<html lang="ko">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>ID / PW 찾기</title>
		<style>
			body {
				margin: 0;
				padding: 0;
				background-color: #f9f9f9;
				display: flex;
				justify-content: center;
				align-items: center;
				height: 100vh;
			}
			.container {
				display: flex;
				justify-content: center;
				align-items: center;
				padding: 60px 20px;
			}
			.find-container {
				background-color: #ffffff;
				padding: 30px;
				border-radius: 10px;
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
				width: 100%;
				max-width: 400px;
				box-sizing: border-box;
			}
			.tabs {
				display: flex;
				border: 1px solid #dddddd;
				border-radius: 6px;
				overflow: hidden;
				margin-bottom: 20px;
			}
			.tab {
				flex: 1;
				padding: 10px 0;
				text-align: center;
				background-color: #f1f1f1;
				font-weight: 500;
				cursor: pointer;
				border-right: 1px solid #dddddd;
			}
			.tab:last-child {
				border-right: none;
			}
			.tab.active {
				background-color: #ffffff;
				font-weight: bold;
			}
			.form-group {
				margin-bottom: 16px;
			}

			.form-group label {
				display: block;
				margin-bottom: 6px;
				font-size: 14px;
				color: #333;
			}

			.form-group input[type='text'],
			.form-group input[type='tel'] {
				width: 100%;
				padding: 10px;
				font-size: 14px;
				border: 1px solid #ccc;
				border-radius: 6px;
				box-sizing: border-box;
			}

			.input-row {
				display: flex;
				gap: 8px;
			}

			.input-row input[type='text'],
			.input-row input[type='tel'] {
				flex: 1;
			}

			.input-row button {
				white-space: nowrap;
				padding: 10px 14px;
				background-color: #eee;
				border: 1px solid #ccc;
				border-radius: 6px;
				font-size: 13px;
				cursor: pointer;
			}

			.submit-btn {
				width: 100%;
				background-color: #333;
				color: white;
				border: none;
				padding: 12px;
				border-radius: 6px;
				font-size: 15px;
				cursor: pointer;
				margin-top: 10px;
			}

			/* 팝업 스타일 */
			.popup-overlay {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: rgba(0, 0, 0, 0.3);
				display: none;
				justify-content: center;
				align-items: center;
				z-index: 1000;
			}

			.popup-box {
				background: white;
				padding: 24px 20px;
				border-radius: 10px;
				text-align: center;
				width: 80%;
				max-width: 280px;
				box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
			}

			.popup-box p {
				font-size: 15px;
				margin-bottom: 20px;
			}

			.popup-box button {
				background-color: #555;
				color: white;
				border: none;
				padding: 8px 20px;
				border-radius: 6px;
				font-size: 14px;
				cursor: pointer;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<div class="find-container">
				<div class="tabs">
					<div class="tab active" onclick="showTab('id')">ID 찾기</div>
					<div class="tab" onclick="showTab('pw')">PW 찾기</div>
				</div>
				<!-- 이름입력 -->
				<div id="id-tab">
					<div class="form-group">
						<label>이름</label>
						<input type="text" id="id-name" placeholder="이름 입력" />
					</div>
					<!-- 인증번호 발송창 -->
					<div class="form-group">
						<label>휴대폰 번호</label>
						<div class="input-row">
							<input type="tel" id="id-phone" placeholder="휴대폰 번호 ( - 빼고 입력)" />
							<button id="id-send-btn" onclick="sendIdCode()" disabled>인증번호 발송</button>
						</div>
					</div>
					<!-- 인증 -->
					<div class="form-group">
						<label>인증번호</label>
						<div class="input-row">
							<input type="text" id="id-code" placeholder="인증번호 입력" />
							<button onclick="verifyIdCode()">인증</button>
						</div>
					</div>
					<!-- 아이디 찾기 -->
					<button class="submit-btn" onclick="findId()">아이디 찾기</button>
				</div>
				<!-- PW 찾기 -->
				<!-- 이름입력 -->
				<div id="pw-tab" style="display: none">
					<div class="form-group">
						<label>이름</label>
						<input type="text" id="pw-name" placeholder="이름 입력" />
					</div>
					<!-- 인증번호 발송창 -->
					<div class="form-group">
						<label>휴대폰 번호</label>
						<div class="input-row">
							<input type="tel" id="pw-phone" placeholder="휴대폰 번호 ( - 빼고 입력)" />
							<button id="pw-send-btn" onclick="sendPwCode()" disabled>인증번호 발송</button>
						</div>
					</div>
					<!-- 인증 -->
					<div class="form-group">
						<label>인증번호</label>
						<div class="input-row">
							<input type="text" id="pw-code" placeholder="인증번호 입력" />
							<button onclick="verifyPwCode()">인증</button>
						</div>
					</div>
					<!-- 비밀번호 찾기 -->
					<button class="submit-btn" onclick="findPw()">비밀번호 찾기</button>
				</div>
			</div>
		</div>

		<!-- 팝업 -->
		<div class="popup-overlay" id="popup">
			<div class="popup-box">
				<p id="popup-text">아이디는 admin 입니다.</p>
				<button onclick="closePopup()">확인</button>
			</div>
		</div>

		<script>
			// JS 초기화 시 이벤트 연결
			document.getElementById('id-phone').addEventListener('input', function () {
				document.getElementById('id-send-btn').disabled = this.value.trim() === '';
			});

			document.getElementById('pw-phone').addEventListener('input', function () {
				document.getElementById('pw-send-btn').disabled = this.value.trim() === '';
			});

			//엔터 눌러도 제출
			document.getElementById('id-code').addEventListener('keyup', function (e) {
				if (e.key === 'Enter') verifyIdCode();
			});
			document.getElementById('pw-code').addEventListener('keyup', function (e) {
				if (e.key === 'Enter') verifyPwCode();
			});

			let isIdVerified = false;
			let isPwVerified = false;

			function showTab(tab) {
				document.querySelectorAll('.tab').forEach((t) => t.classList.remove('active'));
				document.querySelectorAll('#id-tab, #pw-tab').forEach((el) => (el.style.display = 'none'));

				if (tab === 'id') {
					document.querySelector('.tab:nth-child(1)').classList.add('active');
					document.getElementById('id-tab').style.display = 'block';
					isPwVerified = false; // 인증 상태 초기화
				} else {
					document.querySelector('.tab:nth-child(2)').classList.add('active');
					document.getElementById('pw-tab').style.display = 'block';
					isIdVerified = false; // 인증 상태 초기화
				}
			}

			// 인증번호 발송
			function sendIdCode() {
				//휴대폰번호 유효성 검사
				const phone = document.getElementById('id-phone').value.trim();
				const phoneRegex = /^\d{10,11}$/;
				if (!phoneRegex.test(phone)) {
					alert('올바른 휴대폰 번호를 입력해주세요.');
					return;
				}
				document.getElementById('id-code').value = '1234';
				alert('ID 찾기 인증번호가 발송되었습니다! (모의 발송)');
			}

			function sendPwCode() {
				const phone = document.getElementById('pw-phone').value.trim();
				const phoneRegex = /^\d{10,11}$/;
				if (!phoneRegex.test(phone)) {
					alert('올바른 휴대폰 번호를 입력해주세요.');
					return;
				}
				document.getElementById('pw-code').value = '1234';
				alert('PW 찾기 인증번호가 발송되었습니다! (모의 발송)');
			}

			// 인증 확인
			function verifyIdCode() {
				const code = document.getElementById('id-code').value;
				if (code === '1234') {
					isIdVerified = true;
					alert('ID 찾기 인증이 완료되었습니다! (모의 인증)');
					document.getElementById('id-send-btn').disabled = true;
				} else {
					alert('인증번호가 올바르지 않습니다.');
				}
			}

			function verifyPwCode() {
				const code = document.getElementById('pw-code').value;
				if (code === '1234') {
					isPwVerified = true;
					alert('PW 찾기 인증이 완료되었습니다! (모의 인증)');
					document.getElementById('pw-send-btn').disabled = true;
				} else {
					alert('인증번호가 올바르지 않습니다.');
				}
			}

			let redirectToLogin = false; // 이동 여부 저장

			// 아이디 찾기
			function findId() {
				const name = document.getElementById('id-name').value.trim();
				const phone = document.getElementById('id-phone').value.trim();

				if (!name || !phone) {
					alert('이름과 휴대폰 번호를 입력해주세요.');
					return;
				}

				if (!isIdVerified) {
					alert('먼저 인증을 완료해주세요.');
					return;
				}

				const users = JSON.parse(localStorage.getItem('userList')) || [];
				const user = users.find((user) => user.name === name && user.tel === phone);

				const popupText = document.getElementById('popup-text');
				if (user) {
					popupText.innerText = `아이디는 "${user.id}" 입니다.`;
					redirectToLogin = true;
				} else {
					popupText.innerText = `일치하는 사용자를 찾을 수 없습니다.`;
					redirectToLogin = false;
				}

				document.getElementById('popup').style.display = 'flex';
			}

			// 비밀번호 찾기
			function findPw() {
				const name = document.getElementById('pw-name').value.trim();
				const phone = document.getElementById('pw-phone').value.trim();

				if (!name || !phone) {
					alert('이름과 휴대폰 번호를 입력해주세요.');
					return;
				}

				if (!isPwVerified) {
					alert('먼저 인증을 완료해주세요.');
					return;
				}

				const users = JSON.parse(localStorage.getItem('userList')) || [];
				const user = users.find((user) => user.name === name && user.tel === phone);

				const popupText = document.getElementById('popup-text');
				if (user) {
					popupText.innerText = `비밀번호는 "${user.password}" 입니다.`;
					redirectToLogin = true;
				} else {
					popupText.innerText = `일치하는 사용자를 찾을 수 없습니다.`;
					redirectToLogin = false;
				}

				document.getElementById('popup').style.display = 'flex';
			}
			// 팝업 닫기 (성공 시에만 이동)
			function closePopup() {
				document.getElementById('popup').style.display = 'none';
				if (redirectToLogin) {
					window.location.href = './login.html';
				}
			}
		</script>
	</body>
</html>
